<html> 
<head>
<link rel="stylesheet" type="text/css" href="http://code.jquery.com/mobile/1.0b2/jquery.mobile-1.0b2.min.css" />
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>
<script type="text/javascript" src="http://code.jquery.com/jquery-1.7.min.js"></script>
<script type="text/javascript" src="http://code.jquery.com/mobile/1.0b2/jquery.mobile-1.0b2.min.js"></script>
</head>
<body>
<div id="map" data-role="page">
    <div data-role="header">
        <h1>Test</h1>
    </div>
    <div data-role="content">
	<p>Test for googlemap</p>
        <div id="map_canvas" style="height:500px; width:100%"></div>
    </div>
</div>
<script>
navigator.geolocation.getCurrentPosition(function(position)
{
        poimg = "http://www.findthebestcarprice.com/public/images/how-to-buy-a-car.png";

    var map = new google.maps.Map(document.getElementById('map_canvas'), {
        zoom: 15,
        center: new google.maps.LatLng(position.coords.latitude, position.coords.longitude),
        mapTypeId: google.maps.MapTypeId.ROADMAP
    });

    var pos, marker, content, infowindow;
					  marker = new google.maps.Marker({
						position: new google.maps.LatLng(position.coords.latitude, position.coords.longitude),
						map: map
					  });
    infowindow = new google.maps.InfoWindow();
                $.ajax({
                url: 'http://pacce7.site11.com/hospital/search_location.php',
                data: {
                  action: 'search_position',
                  latitude: position.coords.latitude,
                  longitude: position.coords.longitude
                },
                type: 'post',
                async: 'true',
                dataType: 'json',
                beforeSend: function() {
                  // This callback function will trigger before data is sent
                },
                complete: function() {
                },
                success: function(result) {
                  if (result.status) {
                    var record = JSON.parse(result.result);
					//alert(record);
					  for (i = 0; i < record.length; i++) {  
					  marker = new google.maps.Marker({
						position: new google.maps.LatLng(record[i].Latitude, record[i].Longitude),
						map: map
					  });

					}
                  } else {
                    alert("Can't access data!");
                  }
                },
                error: function(request, error) {
                  // This callback function will trigger on unsuccessful action               
                  alert('Network error has occurred please try again!');
                }
              });
},
function(error)
{
    // error getting GPS coordinates
    alert('code: ' + error.code + ' with message: ' + error.message + '\n');
}, 
{ enableHighAccuracy: true, maximumAge: 3000, timeout: 5000 });
</script>
</body>
</html>